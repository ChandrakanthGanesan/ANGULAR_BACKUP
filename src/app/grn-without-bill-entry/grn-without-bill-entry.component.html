
<mat-card>
    <mat-card-header style="justify-content: center;">
        <mat-card-title style="color: brown;text-transform: uppercase;font-weight: 600;">Grn Without Bill Entry
        </mat-card-title>
    </mat-card-header>
    <mat-divider></mat-divider>
    <mat-card-content class="mt-3">
        <form [formGroup]="GrnForm">
            <div class="row">
                <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                    <mat-form-field>
                        <mat-label>Grn No</mat-label>
                        <input matInput formControlName="grrno">
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                    <mat-form-field>
                        <mat-label>GRN DATE</mat-label>
                        <input matInput [matDatepicker]="picker" formControlName="GrnDate">
                        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                    <mat-form-field>
                        <mat-label>Dc Date</mat-label>
                        <input matInput [matDatepicker]="picker1" formControlName="DcDate">
                        <mat-datepicker-toggle matIconSuffix [for]="picker1"></mat-datepicker-toggle>
                        <mat-datepicker #picker1></mat-datepicker>
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                    <mat-form-field>
                        <mat-label>Gate Entry Date</mat-label>
                        <input matInput [matDatepicker]="picker2" formControlName="GateEntryDate">
                        <mat-datepicker-toggle matIconSuffix [for]="picker2"></mat-datepicker-toggle>
                        <mat-datepicker #picker2></mat-datepicker>
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                    <mat-form-field>
                        <mat-label>Supplier</mat-label>
                        <mat-select placeholder="---Search---" formControlName="supplier"
                            (selectionChange)="SupplierChange()" >
                            <mat-option>
                                <ngx-mat-select-search [formControl]="filterControl" [clearSearchInput]="true"
                                    placeholderLabel="---Search---">
                                </ngx-mat-select-search></mat-option>
                            <mat-option *ngFor="let item of filteredOptions"
                                [value]="item.supid">{{item.supname}}</mat-option>
                        </mat-select>
                        <mat-error>Field Required</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                    <mat-form-field>
                        <mat-label>Gate Entry No</mat-label>
                        <mat-select formControlName="gateEntryNo" (selectionChange)="gateEntryEvent($event)">
                            <mat-option *ngFor="let item of gateEntryList"
                                [value]="item.gateentryno">{{item.GateEntry_Ref_No}}</mat-option>
                        </mat-select>
                        <mat-error>Field Required</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                    <mat-form-field>
                        <mat-label>Dc No</mat-label>
                        <input type="text" matInput formControlName="Dcno" readonly>
                        <mat-error>Field Required</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                    <mat-radio-group aria-label="Select an option" formControlName="Weighment"
                        (change)="WeighmnetTypeEvent()">
                        <mat-radio-button value="WithoutWeighment">Without Weighment</mat-radio-button>
                        <mat-radio-button value="WithWeighment">With Weighment</mat-radio-button>
                    </mat-radio-group>
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-6">
                    <mat-form-field>
                        <mat-label>Material</mat-label>
                        <mat-select placeholder="---Search---" formControlName="Material"
                            (selectionChange)="RawmaterialChanmgeEvent()">
                            <mat-option (input)="MaterialLoad()">
                                <ngx-mat-select-search [formControl]="materialFilter" placeholderLabel="Search..."
                                    noEntriesFoundLabel="No Results Found">
                                    [clearSearchInput]="true" placeholderLabel="---Search---">
                                </ngx-mat-select-search></mat-option>
                            <mat-option *ngFor="let item of MaterialFilterList"
                                [value]="item.rawmatid">{{item.rawmatname}}</mat-option>
                        </mat-select>
                        <mat-hint>Type Two letters of Material Name To view Material</mat-hint>
                        <mat-error>Field Required</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6" [hidden]="Ticketnumber">
                    <mat-form-field>
                        <mat-label>Ticket Number</mat-label>
                        <mat-select formControlName="ticketNo">
                            <mat-option>--Select--</mat-option>
                            <mat-option *ngFor="let item of Weighment"
                                [value]="item.id">{{item.ticketnumber}}</mat-option>
                        </mat-select>
                        <mat-error>Field Required</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6"
                    *ngIf="this.GrnForm.controls['supplier'].value ==2734 || this.GrnForm.controls['supplier'].value ==13956">
                    <mat-form-field>
                        <mat-label>PoNo</mat-label>
                        <mat-select formControlName="PONO" (selectionChange)="poChangeEvent()">
                            <mat-option *ngFor="let item of PonoList" [value]="item.poid">{{item.pono}}</mat-option>
                        </mat-select>
                        <mat-error>Field Required</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-6 mt-2 border-50 ">
                    <button mat-raised-button class="button" color="primary" type="button" (click)="Add()">Add</button>
                </div>
            </div>

        </form>
        <div class="mat-elevation-z8 mt-3 " *ngIf="TabelHidden">
            <table class="mb-3" mat-table #table [dataSource]="dataSource">
                <ng-container matColumnDef="Material">
                    <th mat-header-cell *matHeaderCellDef style="background-color: rgb(7, 65, 141);"> Material </th>
                    <td mat-cell *matCellDef="let row">{{row.rawmatname}}</td>
                </ng-container>
                <ng-container matColumnDef="Uom">
                    <th mat-header-cell *matHeaderCellDef style="background-color: rgb(7, 65, 141);"> Uom </th>
                    <td mat-cell *matCellDef="let row">{{row.uom}}</td>
                </ng-container>
                <ng-container matColumnDef="Qty">
                    <th mat-header-cell *matHeaderCellDef style="background-color: rgb(7, 65, 141);"> Qty </th>
                    <td mat-cell *matCellDef="let row; let i =index"><input type="number" class="form-control"
                            onwheel="return false;" [(ngModel)]="row.Qty"></td>
                </ng-container>
                <ng-container matColumnDef="Price">
                    <th mat-header-cell *matHeaderCellDef style="background-color: rgb(7, 65, 141);"> Price </th>
                    <td mat-cell *matCellDef="let row; let i = index">
                        <input type="number" class="form-control" [(ngModel)]="row.price" onwheel="return false;"
                            [disabled]="priceDisabled[i]" (ngModelChange)="onPriceChange(i, row.price)">
                    </td>
                    <td mat-footer-cell *matFooterCellDef colspan="4" style="text-align: right;"> Total </td>
                </ng-container>

                <ng-container matColumnDef="Value">
                    <th mat-header-cell *matHeaderCellDef style="background-color: rgb(7, 65, 141);"> Value </th>
                    <td mat-cell *matCellDef="let row">
                        {{ row.Qty * row.price }}
                    </td>
                    <td mat-footer-cell *matFooterCellDef colspan="0" style="text-align: end;font-weight: bolder;">
                        <strong>{{this.getTotalGross()}}</strong> </td>
                </ng-container>
                <ng-container matColumnDef="Action">
                    <th mat-header-cell *matHeaderCellDef style="background-color: rgb(7, 65, 141);"> Action </th>
                    <td mat-cell *matCellDef="let row;let i =index"> <mat-icon color="warn"
                            (click)="deleteMatl(i)">delete</mat-icon>
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="['Material','Uom','Qty','Price','Value','Action'];sticky: true">
                </tr>
                <tr mat-row *matRowDef="let row; columns: ['Material','Uom','Qty','Price','Value','Action'];"
                    [ngClass]="{'disabled-row': GrnForm.controls['Weighment'].value === 'WithWeighment'}">
                </tr>
                <tr mat-footer-row *matFooterRowDef="['Price','Value']; sticky: true"></tr>
            </table>

        </div>
        <div class="float-end mt-3" *ngIf="TabelHidden">
            <button mat-raised-button class="button ml-5 text-white" style="background-color: green;" type="button"
                (click)="saveVaild()" [disabled]="saveBtnDisabled">Save</button>
        </div>
    </mat-card-content>
</mat-card>



<!-- -->